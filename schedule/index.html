<!DOCTYPE html>
<html>
<head>
    <title>Schedule</title>
    <script>
function e(e=new Date){const t=new Date(e);const i=t.getDay();const n=i===0?-6:1-i;t.setDate(t.getDate()+n);t.setHours(0,0,0,0);return t.getTime()}function t(e,t){const i=new Date(t*1e3);i.setHours(0,0,0,0);const n=new Date(t*1e3);n.setHours(23,59,59,999);const l=new Date(e*1e3);if(l<i)return i.getTime()/1e3;if(l>n)return n.getTime()/1e3;return l.getTime()/1e3}function u(e,t,i,n,l){return e[0]>t&&e[0]<t+n&&e[1]>i&&e[1]<i+l}function i(){fetch(f).then(e=>e.json()).then(e=>{d=JSON.parse(e.content);h()})}function s(){fetch(f,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:JSON.stringify(d)})})}function n(e){const t=new Date(e[0]*1e3);const i=new Date(e[1]*1e3);const n=Math.max(e[0],D.week);const l=Math.min(e[1],D.week+7*86400);if(l<=n)return;const o=new Date(n*1e3);const r=new Date(l*1e3);const a=e[2]===1?"#0000FF":"#FFFFFF";const u=e[2]===1?"#FFFFFF":"#000000";let s=new Date(o.getFullYear(),o.getMonth(),o.getDate());while(s<=r){const c=s.getDay()===0?6:s.getDay()-1;let e=s.toDateString()===o.toDateString()?35+(o.getHours()+o.getMinutes()/60)*31:36;let t=s.toDateString()===r.toDateString()?35+(r.getHours()+r.getMinutes()/60)*31:779;e=Math.max(Math.min(e,779),36);t=Math.max(Math.min(t,779),36);b.fillStyle=a;b.fillRect(3+105*c,e,100,t-e);b.fillStyle=u;b.font="9.6px Arial";b.textBaseline="top";b.textAlign="start";const f=s.toDateString()===o.toDateString()?o:new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0);const d=s.toDateString()===r.toDateString()?r:new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59);const g=new Date(Math.min(d.getTime(),r.getTime()));const m=f.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"})+" âž” "+g.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"});b.fillText(m,3+2+105*c,e+2);s.setDate(s.getDate()+1)}}let l,o,b;const r=new URLSearchParams(window.location.search);let a=r.get("key")||window.prompt("Enter key");const c=atob(a).split(",");const f=`https://discord.com/api/v10/webhooks/${c[0]}/${c[3]}/messages/${c[5]}`;let d=[];let D={menus:[0,0],week:e()/1e3,initialWeek:e()/1e3,selected:[0,0,0],builder:[0,0]};window.onload=()=>{l=document.getElementById("image");o=document.getElementById("canvas");b=o.getContext("2d");i();o.onclick=g;h()};function g(e){const a=[e.offsetX,e.offsetY];if(u(a,930,9,15,17)&&D.week>D.initialWeek)D.week-=7*86400;if(u(a,954,9,15,17)&&D.week<D.initialWeek+2*7*86400)D.week+=7*86400;const t=d.filter(e=>e[0]>D.week&&e[0]<D.week+7*86400);t.forEach(e=>{const t=new Date(e[0]*1e3);const i=new Date(e[1]*1e3);let n=new Date(t.getFullYear(),t.getMonth(),t.getDate());while(n<=i){const l=n.getDay()===0?6:n.getDay()-1;const o=n.toDateString()===t.toDateString()?35+(t.getHours()+t.getMinutes()/60)*31:36;const r=n.toDateString()===i.toDateString()?35+(i.getHours()+i.getMinutes()/60)*31:779;if(u(a,3+105*l,o,100,r-o)){D.menus[0]=1;D.selected=[...e]}n.setDate(n.getDate()+1)}});if(u(a,888,691,80,80)){D.menus[1]=1;const i=15*60*1e3;if(D.week===D.initialWeek){const n=Math.ceil(Date.now()/i)*i;D.builder[0]=n/1e3}else{const l=D.week+12*3600;D.builder[0]=l}D.builder[1]=D.builder[0]+1800}m(a);h()}function m(e){if(D.menus[0]===1){if(u(e,950,35,28,28))D.menus[0]=0;if(u(e,950,65,28,28)&&D.selected[2]===0){const t=d.length;d=d.filter(e=>!(e[0]===D.selected[0]&&e[1]===D.selected[1]&&e[2]===D.selected[2]));if(d.length!==t)s();D.menus[0]=0}}if(D.menus[1]===1){const l=1800;const o=28800;const r=D.initialWeek;const a=D.initialWeek+21*86400-60;const i=(e,t)=>{const i=D.builder[1]-D.builder[0];if(e===0){D.builder[0]+=t;D.builder[1]+=t;if(D.builder[0]<r){const n=r-D.builder[0];D.builder[0]+=n;D.builder[1]+=n}if(D.builder[1]>a){const n=D.builder[1]-a;D.builder[0]-=n;D.builder[1]-=n}}if(e===1){D.builder[1]+=t;if(D.builder[1]<D.builder[0]+l)D.builder[1]=D.builder[0]+l;if(D.builder[1]>D.builder[0]+o)D.builder[1]=D.builder[0]+o;if(D.builder[1]>a)D.builder[1]=a}if(D.builder[0]<r)D.builder[0]=r;if(D.builder[1]>a)D.builder[1]=a;if(D.builder[1]-D.builder[0]<l)D.builder[1]=Math.min(D.builder[0]+l,a)};if(u(e,953,224,17,15))i(0,60);if(u(e,953,248,17,15))i(0,-60);if(u(e,821,224,17,15))i(0,3600);if(u(e,821,248,17,15))i(0,-3600);if(u(e,953,291,17,15))i(1,60);if(u(e,953,315,17,15))i(1,-60);if(u(e,821,291,17,15))i(1,3600);if(u(e,821,315,17,15))i(1,-3600);if(u(e,887,169,17,15)){const n=86400;if(D.builder[1]+n<=a){D.builder[0]+=n;D.builder[1]+=n}}if(u(e,887,193,17,15)){const n=86400;if(D.builder[0]-n>=r){D.builder[0]-=n;D.builder[1]-=n}}if(u(e,746,336,42,27)){d.push([D.builder[0],D.builder[1],0]);D.menus[1]=0;s()}if(u(e,950,139,28,28))D.menus[1]=0}}function h(){b.textAlign="start";b.textBaseline="alphabetic";d.sort((e,t)=>e[2]-t[2]);b.clearRect(0,0,980,783);b.drawImage(l,0,0);b.fillStyle="#d8d8d8";if(D.menus[0]===0)b.fillRect(736,35,242,102);if(D.menus[1]===0)b.fillRect(736,139,242,542);if(D.menus[0]===0&&D.menus[1]===0)b.fillRect(736,137,242,2);let e=d.filter(e=>e[0]>D.week&&e[0]<D.week+7*86400);e.forEach(n);let t=new Date(1e3*D.week).toLocaleDateString(undefined,{day:"2-digit",month:"short",year:"numeric"});b.fillStyle="#7F7F7F";b.font="30px Arial";b.textAlign="start";b.textBaseline="alphabetic";b.fillText(t,744,29);if(D.menus[0]===1){w()}if(D.menus[1]===1){S()}}function w(){b.textAlign="start";b.textBaseline="alphabetic";const[e,t,i]=D.selected;const n=new Date(1e3*e);const l=new Date(1e3*t);b.font="24px Arial";b.fillStyle="#7F7F7F";b.textAlign="center";b.fillText(n.toLocaleDateString(undefined,{day:"2-digit",month:"short",weekday:"short"}),853,98);b.textAlign="right";b.fillText(n.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),839,126);b.textAlign="start";b.fillText(l.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),871,126);b.fillStyle=i===1?"#0000FF":"#7F7F7F";b.fillText(i===1?"BEAM":"AVAILABLE",744,67);if(i===1){b.fillStyle="#d8d8d8";b.fillRect(948,65,30,30)}}function S(){b.textBaseline="alphabetic";const[e,t]=D.builder;const i=new Date(1e3*e);const n=new Date(1e3*t);b.font="24px Arial";b.textAlign="center";b.fillStyle="#7F7F7F";b.fillText(i.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),896,250);b.fillText(n.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),896,317);b.textAlign="right";b.fillText(i.toLocaleDateString(undefined,{day:"2-digit",month:"short",weekday:"short"}),876,196);b.textAlign="start"}
    </script>
</head>
<body>
    <canvas id="canvas" width="980" height="783"></canvas>
    <img id="image" src="image-8.png" style="display:none">
</body>
</html>
