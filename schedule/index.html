<!DOCTYPE html>
<html>
<head>
    <title>Schedule</title>
    <script>
function e(e=new Date){const t=new Date(e);const i=t.getDay();const n=i===0?-6:1-i;t.setDate(t.getDate()+n);t.setHours(0,0,0,0);return t.getTime()}function t(e,t){const i=new Date(t*1e3);i.setHours(0,0,0,0);const n=new Date(t*1e3);n.setHours(23,59,59,999);const l=new Date(e*1e3);if(l<i)return i.getTime()/1e3;if(l>n)return n.getTime()/1e3;return l.getTime()/1e3}function u(e,t,i,n,l){return e[0]>t&&e[0]<t+n&&e[1]>i&&e[1]<i+l}function i(){fetch(f).then(e=>e.json()).then(e=>{d=JSON.parse(e.content);b()})}function c(){fetch(f,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:JSON.stringify(d)})})}function n(e){const t=e[0];const i=e[1];const n=e[2];const l=S.week;const o=l+7*86400;const s=Math.max(t,l);const r=Math.min(i,o);if(r<=s){return}const u=new Date(s*1e3);const c=new Date(r*1e3);const a=n===1?"#00AAAA":"#FFFFFF";const f=n===1?"#FFFFFF":"#000000";let d=new Date(u);d.setHours(0,0,0,0);const g=new Date(c);g.setHours(0,0,0,0);while(d<=g){const m=d.getDay()===0?6:d.getDay()-1;const b=new Date(d);const w=new Date(d);w.setHours(23,59,59,999);const h=new Date(Math.max(u.getTime(),b.getTime()));const D=new Date(Math.min(c.getTime(),w.getTime()));if(D>h){const x=35+(h.getHours()+h.getMinutes()/60)*31;const F=35+(D.getHours()+D.getMinutes()/60)*31;k.fillStyle=a;k.fillRect(3+105*m,x,100,F-x);const y=h.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"})+" âž” "+D.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"});if(y.length>0){k.fillStyle=f;k.font="9.6px Arial";k.textBaseline="top";k.textAlign="start";k.fillText(y,3+2+105*m,x+2)}}else{}d.setDate(d.getDate()+1)}}let l,o,k;const s=new URLSearchParams(window.location.search);let r=s.get("key")||window.prompt("Enter key");const a=atob(r).split(",");const f=`https://discord.com/api/v10/webhooks/${a[0]}/${a[3]}/messages/${a[5]}`;let d=[];let S={menus:[0,0],week:e()/1e3,initialWeek:e()/1e3,selected:[0,0,0],builder:[0,0]};window.onload=()=>{l=document.getElementById("image");o=document.getElementById("canvas");k=o.getContext("2d");i();o.onclick=g;b()};function g(e){const r=[e.offsetX,e.offsetY];if(u(r,930,9,15,17)&&S.week>S.initialWeek)S.week-=7*86400;if(u(r,954,9,15,17)&&S.week<S.initialWeek+2*7*86400)S.week+=7*86400;const t=d.filter(e=>e[1]>S.week&&e[0]<S.week+7*86400);t.forEach(e=>{const t=new Date(e[0]*1e3);const i=new Date(e[1]*1e3);let n=new Date(t.getFullYear(),t.getMonth(),t.getDate());while(n<=i){const l=n.getDay()===0?6:n.getDay()-1;const o=n.toDateString()===t.toDateString()?35+(t.getHours()+t.getMinutes()/60)*31:36;const s=n.toDateString()===i.toDateString()?35+(i.getHours()+i.getMinutes()/60)*31:779;if(u(r,3+105*l,o,100,s-o)){S.menus[0]=1;S.selected=[...e]}n.setDate(n.getDate()+1)}});if(u(r,888,691,80,80)){S.menus[1]=1;const i=15*60*1e3;if(S.week===S.initialWeek){const n=Math.ceil(Date.now()/i)*i;S.builder[0]=n/1e3}else{const l=S.week+12*3600;S.builder[0]=l}S.builder[1]=S.builder[0]+1800}m(r);b()}function m(e){if(S.menus[0]===1){if(u(e,950,35,28,28))S.menus[0]=0;if(u(e,950,65,28,28)&&S.selected[2]===0){const t=d.length;d=d.filter(e=>!(e[0]===S.selected[0]&&e[1]===S.selected[1]&&e[2]===S.selected[2]));if(d.length!==t)c();S.menus[0]=0}}if(S.menus[1]===1){const l=1800;const o=28800;const s=S.initialWeek;const r=S.initialWeek+21*86400-60;const i=(e,t)=>{const i=S.builder[1]-S.builder[0];if(e===0){S.builder[0]+=t;S.builder[1]+=t;if(S.builder[0]<s){const n=s-S.builder[0];S.builder[0]+=n;S.builder[1]+=n}if(S.builder[1]>r){const n=S.builder[1]-r;S.builder[0]-=n;S.builder[1]-=n}}if(e===1){S.builder[1]+=t;if(S.builder[1]<S.builder[0]+l)S.builder[1]=S.builder[0]+l;if(S.builder[1]>S.builder[0]+o)S.builder[1]=S.builder[0]+o;if(S.builder[1]>r)S.builder[1]=r}if(S.builder[0]<s)S.builder[0]=s;if(S.builder[1]>r)S.builder[1]=r;if(S.builder[1]-S.builder[0]<l)S.builder[1]=Math.min(S.builder[0]+l,r)};if(u(e,953,224,17,15))i(0,60);if(u(e,953,248,17,15))i(0,-60);if(u(e,821,224,17,15))i(0,3600);if(u(e,821,248,17,15))i(0,-3600);if(u(e,953,291,17,15))i(1,60);if(u(e,953,315,17,15))i(1,-60);if(u(e,821,291,17,15))i(1,3600);if(u(e,821,315,17,15))i(1,-3600);if(u(e,887,169,17,15)){const n=86400;if(S.builder[1]+n<=r){S.builder[0]+=n;S.builder[1]+=n}}if(u(e,887,193,17,15)){const n=86400;if(S.builder[0]-n>=s){S.builder[0]-=n;S.builder[1]-=n}}if(u(e,746,336,42,27)){d.push([S.builder[0],S.builder[1],0]);S.menus[1]=0;c()}if(u(e,950,139,28,28))S.menus[1]=0}}function b(){k.textAlign="start";k.textBaseline="alphabetic";d.sort((e,t)=>e[2]-t[2]);k.clearRect(0,0,980,783);k.drawImage(l,0,0);k.fillStyle="#d8d8d8";if(S.menus[0]===0)k.fillRect(736,35,242,102);if(S.menus[1]===0)k.fillRect(736,139,242,542);if(S.menus[0]===0&&S.menus[1]===0)k.fillRect(736,137,242,2);let e=d.filter(e=>e[1]>S.week&&e[0]<S.week+7*86400);e.forEach(n);let t=new Date(1e3*S.week).toLocaleDateString(undefined,{day:"2-digit",month:"short",year:"numeric"});k.fillStyle="#7F7F7F";k.font="30px Arial";k.textAlign="start";k.textBaseline="alphabetic";k.fillText(t,744,29);if(S.menus[0]===1){w()}if(S.menus[1]===1){h()}}function w(){k.textAlign="start";k.textBaseline="alphabetic";const[e,t,i]=S.selected;const n=new Date(1e3*e);const l=new Date(1e3*t);k.font="24px Arial";k.fillStyle="#7F7F7F";k.textAlign="center";k.fillText(n.toLocaleDateString(undefined,{day:"2-digit",month:"short",weekday:"short"}),853,98);k.textAlign="right";k.fillText(n.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),839,126);k.textAlign="start";k.fillText(l.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),871,126);k.fillStyle=i===1?"#00AAAA":"#7F7F7F";k.fillText(i===1?"BEAM":"AVAILABLE",744,67);if(i===1){k.fillStyle="#d8d8d8";k.fillRect(948,65,30,30)}}function h(){k.textBaseline="alphabetic";const[e,t]=S.builder;const i=new Date(1e3*e);const n=new Date(1e3*t);k.font="24px Arial";k.textAlign="center";k.fillStyle="#7F7F7F";k.fillText(i.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),896,250);k.fillText(n.toLocaleTimeString(undefined,{hour:"numeric",minute:"numeric"}),896,317);k.textAlign="right";k.fillText(i.toLocaleDateString(undefined,{day:"2-digit",month:"short",weekday:"short"}),876,196);k.textAlign="start"}
    </script>
</head>
<body>
    <canvas id="canvas" width="980" height="783"></canvas>
    <img id="image" src="image-8.png" style="display:none">
</body>
</html>
